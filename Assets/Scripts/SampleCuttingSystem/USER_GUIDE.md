# 样本切割系统使用指南

## 📋 概述

这是一个完整的Unity地质样本切割系统，支持从仓库拖拽多层样本到切割台进行精确切割，生成单层样本用于进一步研究。

## 🚀 使用方法

### 1. 进入实验室
- 在主场景使用场景切换工具进入实验室场景
- 或者直接加载 `Laboratory Scene`

### 2. 设置切割台
- 系统会自动在实验台上创建切割台
- 如需手动设置，在场景中添加 `LabCuttingSystemInitializer` 组件并初始化

### 3. 进入切割界面
- 靠近切割台（蓝色立方体）
- 按 **F** 键进入切割界面
- 界面会显示左侧仓库面板和右侧切割区域

### 4. 选择和拖拽样本
- 从左侧仓库面板选择多层地质样本
- 鼠标按住样本并拖拽到右侧的绿色切割区域
- 只有多层样本才能进行切割

### 5. 执行切割
- 样本投放成功后，观察移动的红色切割线
- 切割线会在不同地层之间移动
- 当切割线处于绿色成功区域时，按 **空格键** 进行切割
- 切割成功会生成单层样本并添加到背包

## 🎮 控制说明

### 基本操作
- **F键**: 进入/退出切割界面
- **鼠标拖拽**: 拖拽样本到切割区域
- **空格键**: 在绿色区域进行切割
- **ESC键**: 退出切割界面

### 视觉提示
- **绿色区域**: 可以成功切割的位置
- **红色区域**: 切割失败区域
- **透明样本**: 拖拽时的预览状态
- **黄色背景**: 切割进行中的状态

## 🔧 系统特性

### 智能样本检测
- 自动识别多层和单层样本
- 只允许多层样本进行切割
- 自动为仓库样本添加拖拽功能

### 场景感知
- 系统只在实验室场景中激活
- 自动适配不同的场景布局
- 保护Canvas不被其他系统删除

### 数据兼容性
- 与现有仓库系统完全兼容
- 支持真实地质样本数据
- 智能类型转换确保数据一致性

## 🏗️ 核心组件

### 主要脚本
- `CuttingStationInteraction.cs` - 切割台交互控制
- `SampleCuttingGame.cs` - 切割游戏逻辑
- `SampleDragHandler.cs` - 样本拖拽处理
- `SampleDropZone.cs` - 切割区域投放
- `WarehouseSampleEnhancer.cs` - 仓库样本增强

### 场景管理
- `SceneAwareCuttingSystem.cs` - 场景感知系统
- `LabCuttingSystemInitializer.cs` - 实验室环境初始化

### UI保护
- `CanvasProtector.cs` - 防止UI被意外删除

## 🐛 故障排除

### 常见问题解决

#### 切割台不显示
1. 确认在实验室场景中
2. 手动添加 `LabCuttingSystemInitializer` 并初始化
3. 检查场景中是否有实验台对象

#### 无法拖拽样本
1. 确认样本是多层类型
2. 检查仓库中是否有样本数据
3. 重新打开切割界面刷新样本列表

#### 切割界面不显示
1. 检查是否靠近切割台
2. 确认按下了F键
3. 查看Console是否有错误信息

#### 切割失败
1. 确保在绿色区域按空格键
2. 检查样本数据是否完整
3. 等待切割线移动到正确位置

### 调试功能
- 按 **F9** 显示系统状态
- 按 **F10** 重新初始化系统
- 查看Console日志获取详细信息

## 💡 使用技巧

1. **选择样本**: 优先选择层级较多的钻孔样本
2. **切割时机**: 观察切割线速度，提前准备按键
3. **成功率**: 绿色区域较大时更容易成功
4. **批量处理**: 可以连续切割多个样本

## 🔮 系统扩展

系统采用模块化设计，支持：
- 自定义样本类型
- 新的切割算法
- 不同的UI主题
- 多种切割模式

---

**享受您的地质研究之旅！**