# 钻塔工具功能说明

## 功能概述

钻塔工具是一个全新的可放置工具，扩展了原有的地质钻探系统。它允许玩家在同一位置进行多次深度钻探，每次探索更深的地层。

## 主要特性

### 🏗️ 可放置钻塔
- 从Tab工具轮盘中选择"钻塔工具"
- 放置在地面上形成永久的钻探站点
- 钻塔外观包含塔身、钻探臂、钻头和底座

### 📏 多层深度钻探
- **第1次钻探**: 0-2m 深度
- **第2次钻探**: 2-4m 深度  
- **第3次钻探**: 4-6m 深度
- **第4次钻探**: 6-8m 深度
- **第5次钻探**: 8-10m 深度
- 每个位置最多可钻探5次

### 🔄 环形样本排列
- 样本自动围绕钻塔呈环形排列
- 每个样本都有深度标签显示
- 样本悬浮在空中，便于观察
- 自动避免重叠，随钻探次数增加调整半径

### 🎯 交互式钻探
- 放置钻塔后，靠近钻塔（3米范围内）
- 点击左键开始钻探
- 钻探过程有视觉和音效反馈
- 钻塔状态显示（工作中/闲置）

## 使用流程

1. **选择工具**: 按Tab键打开工具轮盘，选择钻塔工具
2. **放置钻塔**: 瞄准地面位置，左键放置钻塔
3. **进行钻探**: 
   - 靠近钻塔（出现交互提示）
   - 左键点击开始第一次钻探（0-2m）
   - 等待钻探完成，样本出现在钻塔周围
   - 重复操作进行更深层钻探
4. **查看结果**: 观察环形排列的不同深度样本

## 技术特性

### 🔧 与现有系统集成
- 使用 GeometricSampleReconstructor 进行真实地质采样
- 支持全局射线检测算法
- 保持与原有地质系统的兼容性

### 📊 样本标识
- 每个样本都有 DepthSampleMarker 组件
- 显示钻探次数和深度范围
- 支持详细的样本信息查询

### 🎨 视觉反馈
- 钻塔状态材质变化（工作中/闲置）
- 样本深度标签自动面向玩家
- 环形排列避免视觉混乱

## 文件结构

```
Assets/Scripts/
├── DrillTowerTool.cs          # 主要工具类
├── DrillTowerSetup.cs         # 工具设置和预制件创建
├── GameInitializer.cs         # 游戏初始化管理
└── DrillTowerFeatures.md      # 本说明文件
```

## 主要类

- **DrillTowerTool**: 继承自 PlaceableTool，主要工具逻辑
- **DrillTower**: 钻塔组件，管理钻探状态和逻辑
- **DepthSampleMarker**: 样本标记组件，存储深度信息
- **RotateTowardsPlayer**: 文字标签面向玩家组件
- **DrillTowerSetup**: 自动设置工具和预制件
- **GameInitializer**: 游戏启动时初始化新功能

## 配置参数

### 钻塔工具参数
- `maxDrillDepths`: 最大钻探次数 (默认5次)
- `depthPerDrill`: 每次钻探深度 (默认2m)
- `interactionRange`: 交互范围 (默认3m)

### 样本排列参数
- `sampleRingRadius`: 样本环形半径 (默认2.5m)
- `sampleElevation`: 样本悬浮高度 (默认1.2m)
- `sampleSpacing`: 样本间最小间距 (默认0.8m)

## 后续扩展建议

1. **更多钻探深度**: 可扩展到10-12m, 12-14m等更深层
2. **钻塔升级**: 不同等级钻塔支持不同最大深度
3. **批量分析**: 对同一钻塔的所有样本进行统计分析
4. **钻探记录**: 保存钻探历史和地质剖面图
5. **移动钻塔**: 支持拆除和重新放置钻塔

## 调试信息

所有关键操作都有详细的控制台日志输出，便于调试和监控钻塔工具的运行状态。

---

**版本**: v1.1
**创建日期**: 2025-07-08
**兼容版本**: Unity 2022.3+ LTS